<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Leam Config</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .subreddit-input { margin-bottom: 5px; }
        button { margin-left: 5px; }
    </style>
</head>
<body>
    <h1>Reddit Story Fetcher</h1>
    <form method="post">
        <!-- API Keys -->
        <label for="reddit_client_id">Reddit Client ID:</label>
        <input type="text" id="reddit_client_id" name="reddit_client_id" required><br>

        <label for="reddit_client_secret">Reddit Client Secret:</label>
        <input type="text" id="reddit_client_secret" name="reddit_client_secret" required><br><br>

        <!-- Dynamic Subreddit Fields -->
        <label>Subreddits:</label>
        <div id="subreddits">
            <div class="subreddit-input">
                <input type="text" name="subreddit[]" placeholder="e.g., gaming" required>
                <button type="button" onclick="removeField(this)">-</button>
            </div>
        </div>
        <button type="button" onclick="addField()">+</button><br><br>

        <!-- Score & Min length -->
        <label for="min_score">Minimum Score:</label>
        <input type="number" id="min_score" name="min_score" value="0"><br>

        <label for="min_length">Minimum Story Length (chars):</label>
        <input type="number" id="min_length" name="min_length" value="50"><br><br>

        <button type="submit">Fetch Stories</button>
    </form>

    {% if posts %}
        <h2>Fetched Posts</h2>
        <ul>
            {% for post in posts %}
                <li>
                    <strong>{{ post.title }}</strong><br>
                    {{ post.selftext }}<br>
                    <em>Score: {{ post.score }}</em> | 
                    <a href="{{ post.url }}" target="_blank">Link</a>
                </li>
            {% endfor %}
        </ul>
    {% endif %}

<script>
function addField() {
    const container = document.getElementById('subreddits');
    const div = document.createElement('div');
    div.className = 'subreddit-input';
    div.innerHTML = `<input type="text" name="subreddit[]" placeholder="e.g., gaming" required>
                     <button type="button" onclick="removeField(this)">-</button>`;
    container.appendChild(div);
}

function removeField(button) {
    const div = button.parentNode;
    div.parentNode.removeChild(div);
}
</script>

</body>
</html>